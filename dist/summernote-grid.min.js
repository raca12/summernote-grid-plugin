!function(e){"use strict";var t=[{label:"2 Kolon",cols:[6,6]},{label:"3 Kolon",cols:[4,4,4]},{label:"4 Kolon",cols:[3,3,3,3]},{label:"6 Kolon",cols:[2,2,2,2,2,2]},{label:"12 Kolon",cols:[1,1,1,1,1,1,1,1,1,1,1,1]},{label:"8 + 4",cols:[8,4]},{label:"4 + 8",cols:[4,8]},{label:"9 + 3",cols:[9,3]},{label:"3 + 9",cols:[3,9]},{label:"3 + 6 + 3",cols:[3,6,3]},{label:"2 + 8 + 2",cols:[2,8,2]},{label:"4 + 4 + 4",cols:[4,4,4]}];e.extend(!0,e.summernote,{plugins:{gridPlugin:function(n){var i=e.summernote.ui,o=n.layoutInfo.editable,l=this;this.lastActiveCol=null,this.lastActiveTime=0;n.memo("button.grid",function(){return i.buttonGroup([i.button({className:"dropdown-toggle",contents:'<i class="bi bi-grid-3x2-gap"></i> <span class="note-icon-caret"></span>',tooltip:"Grid Ekle",data:{toggle:"dropdown"}}),i.dropdown({className:"dropdown-menu",contents:l.buildDropdown(),callback:function(n){n.find("[data-grid-index]").on("click",function(n){n.preventDefault(),n.stopPropagation(),l.insertGrid(t[e(this).data("grid-index")])})}})]).render()}),this.buildDropdown=function(){var n="";return e.each(t,function(t,i){var o='<span style="display:inline-flex;gap:1px;margin-right:8px;vertical-align:middle;">';e.each(i.cols,function(e,t){var n=Math.max(3,Math.round(3.5*t));o+='<span style="display:inline-block;width:'+n+'px;height:12px;background:#6c757d;border-radius:1px;"></span>'}),n+='<li><a class="dropdown-item" href="#" data-grid-index="'+t+'">'+(o+="</span>")+i.label+"</a></li>"}),n},this.insertGrid=function(t){var i=document.createElement("div");i.className="row sn-grid",i.setAttribute("contenteditable","false");for(var o=0;o<t.cols.length;o++){var r=document.createElement("div");r.className="col-md-"+t.cols[o]+" sn-grid-col",r.setAttribute("contenteditable","true"),r.innerHTML="<p><br></p>",i.appendChild(r)}var s=document.createElement("p");s.innerHTML="<br>",n.invoke("editor.insertNode",i),e(i).after(s),l.protectRow(e(i)),l.focusCol(i.querySelector(".sn-grid-col"))},this.focusCol=function(e){if(e){e.focus();var t=document.createRange(),n=window.getSelection(),i=e.querySelector("p")||e;t.selectNodeContents(i),t.collapse(!1),n.removeAllRanges(),n.addRange(t),l.setActiveCol(e)}},this.setActiveCol=function(e){l.lastActiveCol=e,l.lastActiveTime=Date.now()},this.isColActive=function(){return l.lastActiveCol&&e.contains(o[0],l.lastActiveCol)&&Date.now()-l.lastActiveTime<3e4},this.isMediaNode=function(t){if(1!==t.nodeType)return!1;var n=t.tagName;return"IFRAME"===n||"IMG"===n||"VIDEO"===n||"AUDIO"===n||(!!e(t).hasClass("note-video-clip")||e(t).find("iframe,img,video").length>0)},this.protectRow=function(t){t.find(".sn-grid-col").each(function(){var t=e(this);t.on("mousedown focusin",function(){l.setActiveCol(this)}),t.on("paste",function(t){t.stopPropagation(),t.preventDefault();var n=(t.originalEvent||t).clipboardData,i=n.getData("text/html"),o=n.getData("text/plain");if(i){var l=e("<div>").html(i);l.find("script,style,meta,link").remove(),i=l.html(),document.execCommand("insertHTML",!1,i)}else if(o){var r=e("<div>").text(o).html().replace(/\n/g,"<br>");document.execCommand("insertHTML",!1,r)}}),t.on("keydown",function(e){if("Backspace"===e.key||"Delete"===e.key){var n=this.innerHTML.replace(/<br\s*\/?>/gi,"").replace(/<p>\s*<\/p>/gi,"").trim();n&&""!==n||(e.preventDefault(),this.innerHTML="<p><br></p>")}if("Tab"===e.key){e.preventDefault(),e.stopPropagation();var i=t.siblings(".sn-grid-col").addBack(),o=i.index(t),r=e.shiftKey?i.eq(o-1):i.eq(o+1);r.length&&l.focusCol(r[0])}}),t.on("drop",function(e){e.stopPropagation()})})},this.observer=null,this.startObserver=function(){l.observer||(l.observer=new MutationObserver(function(t){l.isColActive()&&t.forEach(function(t){if("childList"===t.type&&t.target===o[0])for(var n=0;n<t.addedNodes.length;n++){var i=t.addedNodes[n];if(!e(i).hasClass("sn-grid")&&!e(i).hasClass("sn-grid-col")&&l.isMediaNode(i)){var r=l.lastActiveCol;l.observer.disconnect(),r.appendChild(i),l.observer.observe(o[0],{childList:!0,subtree:!1})}}})}),l.observer.observe(o[0],{childList:!0,subtree:!1}))},this.initialize=function(){o.find(".sn-grid").each(function(){e(this).attr("contenteditable","false"),e(this).find(".sn-grid-col").attr("contenteditable","true"),l.protectRow(e(this))}),o.find(".row:not(.sn-grid)").each(function(){var t=e(this);t.children('[class*="col-"]').length>0&&(t.addClass("sn-grid").attr("contenteditable","false"),t.children('[class*="col-"]').addClass("sn-grid-col").attr("contenteditable","true"),l.protectRow(t))}),l.startObserver()},this.destroy=function(){l.observer&&(l.observer.disconnect(),l.observer=null)},this.cleanHTML=function(t){var n=e("<div>").html(t);return n.find(".sn-grid").removeAttr("contenteditable"),n.find(".sn-grid-col").removeAttr("contenteditable"),n.find(".sn-grid-delete").remove(),n.html()},o.on("click",".sn-grid",function(t){if(e(t.target).hasClass("sn-grid")){var n=e(this);o.find(".sn-grid-delete").remove();var i=e('<button type="button" class="sn-grid-delete" title="Grid\'i sil">&times;</button>');n.css("position","relative").prepend(i),i.on("click",function(e){e.preventDefault(),e.stopPropagation(),n.remove()})}}),o.on("click",function(t){e(t.target).closest(".sn-grid").length||(o.find(".sn-grid-delete").remove(),e(t.target).closest(".note-toolbar").length||(l.lastActiveCol=null))})}}})}(jQuery);